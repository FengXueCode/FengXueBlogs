---
title: è®¾è®¡æ¨¡å¼
categories:
 - è®¾è®¡æ¨¡å¼
---



# è®¾è®¡æ¨¡å¼



## ä¸€ã€è®¾è®¡æ¨¡å¼çš„ç±»å‹



| åºå· | æ¨¡å¼ & æè¿°                                                  | åŒ…æ‹¬                                                         |
| :--- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| 1    | **åˆ›å»ºå‹æ¨¡å¼** è¿™äº›è®¾è®¡æ¨¡å¼æä¾›äº†ä¸€ç§åœ¨åˆ›å»ºå¯¹è±¡çš„åŒæ—¶éšè—åˆ›å»ºé€»è¾‘çš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ new è¿ç®—ç¬¦ç›´æ¥å®ä¾‹åŒ–å¯¹è±¡ã€‚è¿™ä½¿å¾—ç¨‹åºåœ¨åˆ¤æ–­é’ˆå¯¹æŸä¸ªç»™å®šå®ä¾‹éœ€è¦åˆ›å»ºå“ªäº›å¯¹è±¡æ—¶æ›´åŠ çµæ´»ã€‚ | å·¥å‚æ¨¡å¼ï¼ˆFactory Patternï¼‰æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstract Factory Patternï¼‰å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰å»ºé€ è€…æ¨¡å¼ï¼ˆBuilder Patternï¼‰åŸå‹æ¨¡å¼ï¼ˆPrototype Patternï¼‰ |
| 2    | **ç»“æ„å‹æ¨¡å¼** è¿™äº›æ¨¡å¼å…³æ³¨å¯¹è±¡ä¹‹é—´çš„ç»„åˆå’Œå…³ç³»ï¼Œæ—¨åœ¨è§£å†³å¦‚ä½•æ„å»ºçµæ´»ä¸”å¯å¤ç”¨çš„ç±»å’Œå¯¹è±¡ç»“æ„ã€‚ | é€‚é…å™¨æ¨¡å¼ï¼ˆAdapter Patternï¼‰æ¡¥æ¥æ¨¡å¼ï¼ˆBridge Patternï¼‰è¿‡æ»¤å™¨æ¨¡å¼ï¼ˆFilterã€Criteria Patternï¼‰ç»„åˆæ¨¡å¼ï¼ˆComposite Patternï¼‰è£…é¥°å™¨æ¨¡å¼ï¼ˆDecorator Patternï¼‰å¤–è§‚æ¨¡å¼ï¼ˆFacade Patternï¼‰äº«å…ƒæ¨¡å¼ï¼ˆFlyweight Patternï¼‰ä»£ç†æ¨¡å¼ï¼ˆProxy Patternï¼‰ |
| 3    | **è¡Œä¸ºå‹æ¨¡å¼** è¿™äº›æ¨¡å¼å…³æ³¨å¯¹è±¡ä¹‹é—´çš„é€šä¿¡å’Œäº¤äº’ï¼Œæ—¨åœ¨è§£å†³å¯¹è±¡ä¹‹é—´çš„è´£ä»»åˆ†é…å’Œç®—æ³•çš„å°è£…ã€‚ | è´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibility Patternï¼‰å‘½ä»¤æ¨¡å¼ï¼ˆCommand Patternï¼‰è§£é‡Šå™¨æ¨¡å¼ï¼ˆInterpreter Patternï¼‰è¿­ä»£å™¨æ¨¡å¼ï¼ˆIterator Patternï¼‰ä¸­ä»‹è€…æ¨¡å¼ï¼ˆMediator Patternï¼‰å¤‡å¿˜å½•æ¨¡å¼ï¼ˆMemento Patternï¼‰è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserver Patternï¼‰çŠ¶æ€æ¨¡å¼ï¼ˆState Patternï¼‰ç©ºå¯¹è±¡æ¨¡å¼ï¼ˆNull Object Patternï¼‰ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰æ¨¡æ¿æ¨¡å¼ï¼ˆTemplate Patternï¼‰è®¿é—®è€…æ¨¡å¼ï¼ˆVisitor Patternï¼‰ |
| 4    | **J2EE æ¨¡å¼** è¿™äº›è®¾è®¡æ¨¡å¼ç‰¹åˆ«å…³æ³¨è¡¨ç¤ºå±‚ã€‚è¿™äº›æ¨¡å¼æ˜¯ç”± Sun Java Center é‰´å®šçš„ã€‚ | MVC æ¨¡å¼ï¼ˆMVC Patternï¼‰ä¸šåŠ¡ä»£è¡¨æ¨¡å¼ï¼ˆBusiness Delegate Patternï¼‰ç»„åˆå®ä½“æ¨¡å¼ï¼ˆComposite Entity Patternï¼‰æ•°æ®è®¿é—®å¯¹è±¡æ¨¡å¼ï¼ˆData Access Object Patternï¼‰å‰ç«¯æ§åˆ¶å™¨æ¨¡å¼ï¼ˆFront Controller Patternï¼‰æ‹¦æˆªè¿‡æ»¤å™¨æ¨¡å¼ï¼ˆIntercepting Filter Patternï¼‰æœåŠ¡å®šä½å™¨æ¨¡å¼ï¼ˆService Locator Patternï¼‰ä¼ è¾“å¯¹è±¡æ¨¡å¼ï¼ˆTransfer Object Patternï¼‰ |

ä¸‹é¢ç”¨ä¸€ä¸ªå›¾ç‰‡æ¥æ•´ä½“æè¿°ä¸€ä¸‹è®¾è®¡æ¨¡å¼ä¹‹é—´çš„å…³ç³»ï¼š

![è®¾è®¡æ¨¡å¼ä¹‹é—´çš„å…³ç³»](https://www.runoob.com/wp-content/uploads/2014/08/mmexport1707099938077.png)



## äºŒã€è®¾è®¡æ¨¡å¼çš„å…­å¤§åŸåˆ™



**1ã€å¼€é—­åŸåˆ™ï¼ˆOpen Close Principleï¼‰**

å¼€é—­åŸåˆ™çš„æ„æ€æ˜¯ï¼š**å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­**ã€‚åœ¨ç¨‹åºéœ€è¦è¿›è¡Œæ‹“å±•çš„æ—¶å€™ï¼Œä¸èƒ½å»ä¿®æ”¹åŸæœ‰çš„ä»£ç ï¼Œå®ç°ä¸€ä¸ªçƒ­æ’æ‹”çš„æ•ˆæœã€‚ç®€è¨€ä¹‹ï¼Œæ˜¯ä¸ºäº†ä½¿ç¨‹åºçš„æ‰©å±•æ€§å¥½ï¼Œæ˜“äºç»´æŠ¤å’Œå‡çº§ã€‚æƒ³è¦è¾¾åˆ°è¿™æ ·çš„æ•ˆæœï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ¥å£å’ŒæŠ½è±¡ç±»ï¼Œåé¢çš„å…·ä½“è®¾è®¡ä¸­æˆ‘ä»¬ä¼šæåˆ°è¿™ç‚¹ã€‚

**2ã€é‡Œæ°ä»£æ¢åŸåˆ™ï¼ˆLiskov Substitution Principleï¼‰**

 é‡Œæ°ä»£æ¢åŸåˆ™ä¸­è¯´ï¼Œä»»ä½•0åŸºç±»å¯ä»¥å‡ºç°çš„åœ°æ–¹ï¼Œå­ç±»ä¸€å®šå¯ä»¥å‡ºç°ã€‚LSP æ˜¯ç»§æ‰¿å¤ç”¨çš„åŸºçŸ³ï¼Œåªæœ‰å½“æ´¾ç”Ÿç±»å¯ä»¥æ›¿æ¢æ‰åŸºç±»ï¼Œä¸”è½¯ä»¶å•ä½çš„åŠŸèƒ½ä¸å—åˆ°å½±å“æ—¶ï¼ŒåŸºç±»æ‰èƒ½çœŸæ­£è¢«å¤ç”¨ï¼Œè€Œæ´¾ç”Ÿç±»ä¹Ÿèƒ½å¤Ÿåœ¨åŸºç±»çš„åŸºç¡€ä¸Šå¢åŠ æ–°çš„è¡Œä¸ºã€‚é‡Œæ°ä»£æ¢åŸåˆ™æ˜¯å¯¹å¼€é—­åŸåˆ™çš„è¡¥å……ã€‚å®ç°å¼€é—­åŸåˆ™çš„å…³é”®æ­¥éª¤å°±æ˜¯**æŠ½è±¡åŒ–**ï¼Œè€ŒåŸºç±»ä¸å­ç±»çš„ç»§æ‰¿å…³ç³»å°±æ˜¯æŠ½è±¡åŒ–çš„å…·ä½“å®ç°ï¼Œæ‰€ä»¥é‡Œæ°ä»£æ¢åŸåˆ™æ˜¯å¯¹å®ç°æŠ½è±¡åŒ–çš„å…·ä½“æ­¥éª¤çš„è§„èŒƒã€‚

**3ã€ä¾èµ–å€’è½¬åŸåˆ™ï¼ˆDependence Inversion Principleï¼‰**

è¿™ä¸ªåŸåˆ™æ˜¯å¼€é—­åŸåˆ™çš„åŸºç¡€ï¼Œå…·ä½“å†…å®¹ï¼šé’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œä¾èµ–äºæŠ½è±¡è€Œä¸ä¾èµ–äºå…·ä½“ã€‚

**4ã€æ¥å£éš”ç¦»åŸåˆ™ï¼ˆInterface Segregation Principleï¼‰**

è¿™ä¸ªåŸåˆ™çš„æ„æ€æ˜¯ï¼šä½¿ç”¨å¤šä¸ªéš”ç¦»çš„æ¥å£ï¼Œæ¯”ä½¿ç”¨å•ä¸ªæ¥å£è¦å¥½ã€‚å®ƒè¿˜æœ‰å¦å¤–ä¸€ä¸ªæ„æ€æ˜¯ï¼šé™ä½ç±»ä¹‹é—´çš„è€¦åˆåº¦ã€‚ç”±æ­¤å¯è§ï¼Œå…¶å®è®¾è®¡æ¨¡å¼å°±æ˜¯ä»å¤§å‹è½¯ä»¶æ¶æ„å‡ºå‘ã€ä¾¿äºå‡çº§å’Œç»´æŠ¤çš„è½¯ä»¶è®¾è®¡æ€æƒ³ï¼Œå®ƒå¼ºè°ƒé™ä½ä¾èµ–ï¼Œé™ä½è€¦åˆã€‚

**5ã€è¿ªç±³ç‰¹æ³•åˆ™ï¼Œåˆç§°æœ€å°‘çŸ¥é“åŸåˆ™ï¼ˆDemeter Principleï¼‰**

æœ€å°‘çŸ¥é“åŸåˆ™æ˜¯æŒ‡ï¼šä¸€ä¸ªå®ä½“åº”å½“å°½é‡å°‘åœ°ä¸å…¶ä»–å®ä½“ä¹‹é—´å‘ç”Ÿç›¸äº’ä½œç”¨ï¼Œä½¿å¾—ç³»ç»ŸåŠŸèƒ½æ¨¡å—ç›¸å¯¹ç‹¬ç«‹ã€‚

**6ã€åˆæˆå¤ç”¨åŸåˆ™ï¼ˆComposite Reuse Principleï¼‰**

åˆæˆå¤ç”¨åŸåˆ™æ˜¯æŒ‡ï¼šå°½é‡ä½¿ç”¨**åˆæˆ/èšåˆ**çš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç»§æ‰¿ã€‚



## ä¸‰ã€è®¾è®¡æ¨¡å¼è¯¦æƒ…

### 3.1 å•ä¾‹æ¨¡å¼

å•ä¾‹æ¨¡å¼ï¼ˆ**Singleton Pattern**ï¼‰æ˜¯ä¸€ç§**åˆ›å»ºå‹è®¾è®¡æ¨¡å¼**ï¼Œç¡®ä¿ä¸€ä¸ªç±»**ä»…æœ‰ä¸€ä¸ªå®ä¾‹**ï¼Œå¹¶æä¾›**å…¨å±€è®¿é—®ç‚¹**ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡**ç§æœ‰åŒ–æ„é€ æ–¹æ³•**å®ç°å®ä¾‹çš„ä¸¥æ ¼æ§åˆ¶ã€‚

**å››å¤§æ ¸å¿ƒè¦ç´ **

1. **ç§æœ‰æ„é€ æ–¹æ³•**ï¼šé˜²æ­¢å¤–éƒ¨ç›´æ¥å®ä¾‹åŒ–
2. **é™æ€ç§æœ‰å®ä¾‹**ï¼šä¿å­˜ç±»çš„å”¯ä¸€å®ä¾‹
3. **é™æ€å…¬æœ‰æ–¹æ³•**ï¼šæä¾›å…¨å±€è®¿é—®å…¥å£ï¼ˆé€šå¸¸æ˜¯`getInstance()`ï¼‰
4. **çº¿ç¨‹å®‰å…¨å¤„ç†**ï¼šé˜²æ­¢å¤šçº¿ç¨‹ç¯å¢ƒä¸‹äº§ç”Ÿå¤šä¸ªå®ä¾‹

#### 3.1.1 é¥¿æ±‰å¼

```
public class EagerSingleton {
    // ç±»åŠ è½½æ—¶å³åˆå§‹åŒ–å®ä¾‹
    private static final EagerSingleton instance = new EagerSingleton();
    
    private EagerSingleton() {} // ç§æœ‰æ„é€ 
    
    public static EagerSingleton getInstance() {
        return instance;
    }
}
```

**ä¼˜ç‚¹**ï¼šçº¿ç¨‹å®‰å…¨ï¼Œå®ç°ç®€å•
**ç¼ºç‚¹**ï¼šç±»åŠ è½½æ—¶å³åˆ›å»ºå®ä¾‹ï¼ˆå³ä½¿ä¸éœ€è¦ï¼‰ï¼Œå¯èƒ½æµªè´¹èµ„æº

#### 3.1.2 æ‡’æ±‰å¼

```
public class LazySingleton {
    private static LazySingleton instance;
    
    private LazySingleton() {}
    
    public static LazySingleton getInstance() {
        if (instance == null) {
            instance = new LazySingleton(); // éåŸå­æ“ä½œ
        }
        return instance;
    }
}
```

**é—®é¢˜**ï¼šå¤šçº¿ç¨‹å¯èƒ½åˆ›å»ºå¤šä¸ªå®ä¾‹ï¼ˆAã€Bçº¿ç¨‹åŒæ—¶é€šè¿‡`instance==null`æ£€æŸ¥ï¼‰



åŒé‡æ£€æŸ¥é”

```
public class DCLSingleton {
    // volatileé˜²æ­¢æŒ‡ä»¤é‡æ’åº
    private static volatile DCLSingleton instance;
    
    private DCLSingleton() {}
    
    public static DCLSingleton getInstance() {
        if (instance == null) { // ç¬¬ä¸€æ¬¡æ£€æŸ¥
            synchronized (DCLSingleton.class) {
                if (instance == null) { // ç¬¬äºŒæ¬¡æ£€æŸ¥
                    instance = new DCLSingleton();
                }
            }
        }
        return instance;
    }
}
```

**ä¼˜ç‚¹**ï¼šçº¿ç¨‹å®‰å…¨ + å»¶è¿ŸåŠ è½½ + é«˜æ€§èƒ½
**è¦ç‚¹**ï¼šå¿…é¡»ä½¿ç”¨`volatile`ä¿®é¥°å®ä¾‹ï¼ˆé˜²æ­¢æŒ‡ä»¤é‡æ’åºï¼‰



é™æ€å†…éƒ¨ç±»

```
public class InnerClassSingleton {
    private InnerClassSingleton() {}
    
    // é™æ€å†…éƒ¨ç±»åœ¨é¦–æ¬¡è°ƒç”¨getInstance()æ—¶åŠ è½½
    private static class Holder {
        private static final InnerClassSingleton INSTANCE = new InnerClassSingleton();
    }
    
    public static InnerClassSingleton getInstance() {
        return Holder.INSTANCE;
    }
}
```

**ä¼˜åŠ¿**ï¼š

- çº¿ç¨‹å®‰å…¨ï¼ˆJVMä¿è¯ç±»åŠ è½½çº¿ç¨‹å®‰å…¨ï¼‰
- å»¶è¿ŸåŠ è½½ï¼ˆé¦–æ¬¡è°ƒç”¨æ—¶æ‰åˆå§‹åŒ–ï¼‰
- æ— é”é«˜æ€§èƒ½
- é˜²æ­¢åå°„æ”»å‡»ï¼ˆé€šè¿‡ç±»åŠ è½½æœºåˆ¶ï¼‰



æšä¸¾å•ä¾‹

```
public enum EnumSingleton {
    INSTANCE; // å”¯ä¸€å®ä¾‹
    
    // ä¸šåŠ¡æ–¹æ³•
    public void doSomething() {
        System.out.println("Singleton working");
    }
}

// å®¢æˆ·ç«¯è°ƒç”¨
EnumSingleton.INSTANCE.doSomething();
```

**ä¼˜åŠ¿**ï¼š

- ç»å¯¹é˜²æ­¢å¤šæ¬¡å®ä¾‹åŒ–ï¼ˆå³ä½¿åå°„å’Œåºåˆ—åŒ–æ”»å‡»ï¼‰
- ä»£ç æœ€ç®€æ´
- è‡ªåŠ¨æ”¯æŒåºåˆ—åŒ–æœºåˆ¶



|     **ç‰¹æ€§**     |         é¥¿æ±‰å¼ï¼ˆEagerï¼‰         |          æ‡’æ±‰å¼ï¼ˆLazyï¼‰           |
| :--------------: | :-----------------------------: | :-------------------------------: |
|  **å®ä¾‹åŒ–æ—¶æœº**  |       ç±»åŠ è½½æ—¶ç«‹å³åˆå§‹åŒ–        | é¦–æ¬¡è°ƒç”¨`getInstance()`æ—¶æ‰åˆå§‹åŒ– |
|  **çº¿ç¨‹å®‰å…¨æ€§**  |          å¤©ç„¶çº¿ç¨‹å®‰å…¨           |       éœ€è¦æ‰‹åŠ¨å¤„ç†çº¿ç¨‹å®‰å…¨        |
|   **èµ„æºå ç”¨**   |  å¯èƒ½æµªè´¹å†…å­˜ï¼ˆåŠ è½½åä¸ä½¿ç”¨ï¼‰   |        æŒ‰éœ€åŠ è½½ï¼ŒèŠ‚çº¦èµ„æº         |
|   **æ‰§è¡Œé€Ÿåº¦**   |         é¦–æ¬¡è®¿é—®é€Ÿåº¦å¿«          |      é¦–æ¬¡è®¿é—®æ…¢ï¼ˆéœ€åˆå§‹åŒ–ï¼‰       |
|  **å®ç°å¤æ‚åº¦**  |            ç®€å•ç›´æ¥             |   éœ€åŒé‡æ£€æŸ¥é”/é™æ€å†…éƒ¨ç±»ç­‰æœºåˆ¶   |
| **åºåˆ—åŒ–å®‰å…¨æ€§** |          éœ€è¦é¢å¤–å¤„ç†           |           éœ€è¦é¢å¤–å¤„ç†            |
|   **é€‚ç”¨åœºæ™¯**   | å°å‹è½»é‡å¯¹è±¡/å¿…é¡»ç«‹å³ä½¿ç”¨çš„ç»„ä»¶ |   å¤§å‹é‡é‡å¯¹è±¡/å¯èƒ½ä¸ä½¿ç”¨çš„èµ„æº   |



### 3.2 å·¥å‚æ¨¡å¼

å·¥å‚æ¨¡å¼ï¼ˆ**Factory Pattern**ï¼‰æ˜¯ä¸€ç§**åˆ›å»ºå‹è®¾è®¡æ¨¡å¼**ï¼Œç”¨äºå°†å¯¹è±¡çš„åˆ›å»ºé€»è¾‘ä¸ä½¿ç”¨é€»è¾‘åˆ†ç¦»ï¼Œæé«˜ä»£ç çš„çµæ´»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯**å°è£…å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹**ï¼Œå®¢æˆ·ç«¯æ— éœ€å…³å¿ƒå…·ä½“å®ç°ç»†èŠ‚ã€‚

#### 3.2.1 å·¥å‚æ¨¡å¼

```
// 1. æŠ½è±¡å·¥å‚
interface PhoneFactory {
    Phone createPhone();
}

// 2. å…·ä½“å·¥å‚
class iPhoneFactory implements PhoneFactory {
    @Override
    public Phone createPhone() {
        return new iPhone(); // è¿”å›å…·ä½“äº§å“
    }
}

class AndroidFactory implements PhoneFactory {
    @Override
    public Phone createPhone() {
        return new AndroidPhone();
    }
}

// 3. å®¢æˆ·ç«¯ä½¿ç”¨
public class Client {
    public static void main(String[] args) {
        PhoneFactory factory = new iPhoneFactory();
        Phone phone = factory.createPhone();
        phone.call(); // è¾“å‡ºï¼šiPhone calling
    }
}
```

#### 3.2.2 æŠ½è±¡å·¥å‚æ¨¡å¼

```
// 1. æŠ½è±¡äº§å“æ—
interface OSFactory {
    Phone createPhone();
    OS createOS();
}

interface OS {
    void run();
}

// 2. å…·ä½“äº§å“æ— - Appleç”Ÿæ€
class AppleFactory implements OSFactory {
    @Override
    public Phone createPhone() { return new iPhone(); }
    
    @Override
    public OS createOS() { return new IOS(); }
}

class IOS implements OS {
    @Override
    public void run() { System.out.println("iOS running"); }
}

// 3. å…·ä½“äº§å“æ— - Androidç”Ÿæ€
class AndroidFactory implements OSFactory {
    @Override
    public Phone createPhone() { return new AndroidPhone(); }

    @Override
    public OS createOS() { return new AndroidOS(); }
}

class AndroidOS implements OS {
    @Override
    public void run() { System.out.println("Android running"); }
}

// 4. å®¢æˆ·ç«¯ä½¿ç”¨
public class Client {
    public static void main(String[] args) {
        OSFactory factory = new AppleFactory();
        Phone phone = factory.createPhone();
        OS os = factory.createOS();
        
        phone.call(); // iPhone calling
        os.run();     // iOS running
    }
}
```

### 3.3 å»ºé€ è€…æ¨¡å¼

å»ºé€ è€…æ¨¡å¼ï¼ˆ**Builder Pattern**ï¼‰æ˜¯ä¸€ç§**åˆ›å»ºå‹è®¾è®¡æ¨¡å¼**ï¼Œç”¨äº**åˆ†æ­¥éª¤æ„å»ºå¤æ‚å¯¹è±¡**ï¼Œä½¿ç›¸åŒçš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„å¯¹è±¡è¡¨ç¤ºã€‚æ ¸å¿ƒæ€æƒ³æ˜¯**å°†å¯¹è±¡çš„æ„é€ ä¸è¡¨ç¤ºåˆ†ç¦»**ï¼Œä»è€Œå…è®¸çµæ´»æ§åˆ¶å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ã€‚

|      **è§’è‰²**       |           **èŒè´£**           |        **ç¤ºä¾‹**         |
| :-----------------: | :--------------------------: | :---------------------: |
|     **Product**     |     æœ€ç»ˆè¦æ„å»ºçš„å¤æ‚å¯¹è±¡     |       `Computer`        |
|     **Builder**     | å®šä¹‰åˆ›å»ºäº§å“å„éƒ¨åˆ†çš„æŠ½è±¡æ¥å£ |    `ComputerBuilder`    |
| **ConcreteBuilder** | å®ç°Builderæ¥å£çš„å…·ä½“æ„é€ å™¨  | `GamingComputerBuilder` |
|    **Director**     |   æŒ‡æŒ¥æ„å»ºè¿‡ç¨‹çš„ç±»ï¼ˆå¯é€‰ï¼‰   |   `ComputerAssembler`   |

Product

```
public class Computer {
    // å¿…é€‰å‚æ•° (final)
    private final String motherboard;//ä¸»æ¿
    private final String processor;//å¤„ç†å™¨
    
    // å¯é€‰å‚æ•°
    private String graphicsCard;//æ˜¾å¡
    private int ramGB;//å†…å­˜
    private int storageGB;//ç¡¬ç›˜
    private boolean liquidCooling;//æ°´å†·

    // ç§æœ‰æ„é€ æ–¹æ³•ï¼ˆåªèƒ½é€šè¿‡Builderåˆ›å»ºï¼‰
    private Computer(Builder builder) {
        this.motherboard = builder.motherboard;
        this.processor = builder.processor;
        this.graphicsCard = builder.graphicsCard;
        this.ramGB = builder.ramGB;
        this.storageGB = builder.storageGB;
        this.liquidCooling = builder.liquidCooling;
    }
    
    // Getters (çœç•¥settersç¡®ä¿ä¸å¯å˜)
    public String getProcessor() { return processor; }
    // ...å…¶ä»–getters
    
    // é™æ€Builderç±»
    public static class Builder {
        // å¿…é€‰å‚æ•°
        private final String motherboard;
        private final String processor;
        
        // å¯é€‰å‚æ•°ï¼ˆå¸¦é»˜è®¤å€¼ï¼‰
        private String graphicsCard = "Integrated";
        private int ramGB = 8;
        private int storageGB = 256;
        private boolean liquidCooling = false;

        // å¿…é€‰å‚æ•°é€šè¿‡æ„é€ æ–¹æ³•ä¼ å…¥
        public Builder(String motherboard, String processor) {
            this.motherboard = motherboard;
            this.processor = processor;
        }

        // å¯é€‰å‚æ•°çš„é“¾å¼é…ç½®æ–¹æ³•
        public Builder graphicsCard(String graphicsCard) {
            this.graphicsCard = graphicsCard;
            return this;
        }
        
        public Builder ramGB(int ramGB) {
            this.ramGB = ramGB;
            return this;
        }
        
        public Builder storageGB(int storageGB) {
            this.storageGB = storageGB;
            return this;
        }
        
        public Builder liquidCooling(boolean liquidCooling) {
            this.liquidCooling = liquidCooling;
            return this;
        }

        // æ„å»ºæœ€ç»ˆå¯¹è±¡
        public Computer build() {
            validate(); // æ„å»ºå‰æ ¡éªŒ
            return new Computer(this);
        }
        
        private void validate() {
            if (ramGB < 4) 
                throw new IllegalArgumentException("RAMä¸èƒ½å°‘äº4GB");
            // å…¶ä»–æ ¡éªŒè§„åˆ™...
        }
    }
}
```

Director

```
public class ComputerDirector {
    public Computer buildGamingComputer(Computer.Builder builder) {
        return builder
            .graphicsCard("RTX 4090")
            .ramGB(32)
            .storageGB(2000)
            .liquidCooling(true)
            .build();
    }
    
    public Computer buildOfficeComputer(Computer.Builder builder) {
        return builder
            .ramGB(16)
            .storageGB(512)
            .build(); // ä½¿ç”¨é»˜è®¤æ˜¾å¡å’Œæ•£çƒ­
    }
}
```

å®¢æˆ·ç«¯è°ƒç”¨

```
public class Client {
    public static void main(String[] args) {
        // æ–¹æ³•1: ç›´æ¥ä½¿ç”¨Builderé“¾å¼è°ƒç”¨
        Computer gamingPC = new Computer.Builder("ROG Z790", "i9-13900K")
            .graphicsCard("RTX 4090")
            .ramGB(64)
            .storageGB(4000)
            .liquidCooling(true)
            .build();
            
        // æ–¹æ³•2: é€šè¿‡Directoræ„å»º
        ComputerDirector director = new ComputerDirector();
        Computer officePC = director.buildOfficeComputer(
            new Computer.Builder("B660M", "i5-12400")
        );
    }
}
```

### 3.4 åŸå‹æ¨¡å¼

åŸå‹æ¨¡å¼ï¼ˆ**Prototype Pattern**ï¼‰æ˜¯ä¸€ç§**åˆ›å»ºå‹è®¾è®¡æ¨¡å¼**ï¼Œå®ƒé€šè¿‡**å¤åˆ¶ç°æœ‰å¯¹è±¡**æ¥åˆ›å»ºæ–°å¯¹è±¡ï¼Œé¿å…äº†é‡å¤åˆå§‹åŒ–çš„å¼€é”€ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯å°†å¯¹è±¡çš„**å¤åˆ¶èƒ½åŠ›è§£è€¦**ï¼Œä½¿ç³»ç»Ÿæ— éœ€çŸ¥é“å…·ä½“ç±»å‹å³å¯åˆ›å»ºå‰¯æœ¬ã€‚

|       **è§’è‰²**        |          **èŒè´£**          |
| :-------------------: | :------------------------: |
|     **Prototype**     | å®šä¹‰å…‹éš†æ–¹æ³•çš„æ¥å£æˆ–æŠ½è±¡ç±» |
| **ConcretePrototype** |  å®ç°å…‹éš†æ–¹æ³•çš„å…·ä½“åŸå‹ç±»  |
|      **Client**       | é€šè¿‡åŸå‹ç®¡ç†å™¨è¯·æ±‚å¯¹è±¡å…‹éš† |

æµ…å…‹éš†

```
// å®ç°Cloneableæ¥å£å¹¶é‡å†™clone()
public class Document implements Cloneable {
    private String content;
    private List<Image> images; // å¼•ç”¨ç±»å‹
    
    @Override
    public Document clone() {
        try {
            // é»˜è®¤å®ç°æµ…æ‹·è´
            return (Document) super.clone();
        } catch (CloneNotSupportedException e) {
            throw new AssertionError(); // ä¸å¯èƒ½å‘ç”Ÿ
        }
    }
    
    // é—®é¢˜ï¼šimagesåˆ—è¡¨å…±äº«å¼•ç”¨ï¼
}
```

æ·±å…‹éš†

```
// æ·±æ‹·è´åŸå‹å®ç°
public class DeepCopyDocument implements Cloneable {
    private String content;
    private List<Image> images;
    
    @Override
    public DeepCopyDocument clone() {
        try {
            DeepCopyDocument copy = (DeepCopyDocument) super.clone();
            // åˆ›å»ºæ–°åˆ—è¡¨
            copy.images = new ArrayList<>();
            // æ·±åº¦å…‹éš†åˆ—è¡¨å…ƒç´ 
            for (Image image : this.images) {
                copy.images.add(image.clone());
            }
            return copy;
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
}

// Imageä¹Ÿéœ€å®ç°å…‹éš†
public class Image implements Cloneable {
    private byte[] data;
    
    @Override
    public Image clone() {
        try {
            Image copy = (Image) super.clone();
            // å…‹éš†å­—èŠ‚æ•°ç»„ï¼ˆå¼•ç”¨ç±»å‹ï¼‰
            copy.data = this.data.clone();
            return copy;
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
}
```

åºåˆ—åŒ–å®ç°å…‹éš†ï¼ˆæµ)

```
import java.io.*;

public class SerializationPrototype implements Serializable {
    private String data;
    private Map<String, String> meta;
    
    // é€šè¿‡åºåˆ—åŒ–å®ç°æ·±æ‹·è´
    public SerializationPrototype deepCopy() {
        try {
            ByteArrayOutputStream bos = new ByteArrayOutputStream();
            ObjectOutputStream oos = new ObjectOutputStream(bos);
            oos.writeObject(this);
            
            ByteArrayInputStream bis = 
                new ByteArrayInputStream(bos.toByteArray());
            ObjectInputStream ois = new ObjectInputStream(bis);
            return (SerializationPrototype) ois.readObject();
        } catch (IOException | ClassNotFoundException e) {
            throw new RuntimeException("Clone failed", e);
        }
    }
}
```

åŸå‹ç®¡ç†å™¨

```
import java.util.*;

// åŸå‹æ³¨å†Œç®¡ç†å™¨
public class PrototypeRegistry {
    private static final Map<String, Prototype> registry = new HashMap<>();
    
    // åˆå§‹åŒ–æ³¨å†ŒåŸå‹
    static {
        registry.put("basic", new BasicConfig());
        registry.put("advanced", new AdvancedConfig());
        registry.put("custom", new CustomConfig());
    }
    
    // è·å–åŸå‹å‰¯æœ¬
    public static Prototype getClone(String key) {
        Prototype prototype = registry.get(key);
        if (prototype == null) {
            throw new IllegalArgumentException("æœªçŸ¥åŸå‹: " + key);
        }
        return prototype.clone();
    }
    
    // æ·»åŠ æ–°åŸå‹
    public static void registerPrototype(String key, Prototype prototype) {
        registry.put(key, prototype);
    }
}

// å®¢æˆ·ç«¯ä½¿ç”¨
public class Client {
    public static void main(String[] args) {
        // è·å–é…ç½®å‰¯æœ¬
        Prototype config = PrototypeRegistry.getClone("advanced");
        config.apply();
    }
}
```

**ä¸‰å¤§æ ¸å¿ƒä¼˜åŠ¿**

1. **æ€§èƒ½ä¼˜åŒ–**
   ğŸ‘‰ é¿å…æ˜‚è´µåˆå§‹åŒ–æ“ä½œï¼Œç›´æ¥å¤ç”¨å·²å­˜åœ¨çŠ¶æ€
2. **åŠ¨æ€é…ç½®**
   ğŸ‘‰ è¿è¡Œæ—¶åŠ¨æ€æ›¿æ¢åŸå‹å¯¹è±¡æ”¹å˜åˆ›å»ºè¡Œä¸º
3. **ç®€åŒ–å¯¹è±¡åˆ›å»º**
   ğŸ‘‰ å®¢æˆ·ç«¯æ— éœ€çŸ¥é“å…·ä½“åˆ›å»ºç»†èŠ‚



**æ˜¯å¦ä½¿ç”¨åŸå‹æ¨¡å¼ï¼Ÿ**

![image-20250620162206068](https://cdn.jsdelivr.net/gh/FengXueCode/FengXueResource@main/imageimage-20250620162206068.png)

### 3.5 é€‚é…å™¨æ¨¡å¼

é€‚é…å™¨æ¨¡å¼ï¼ˆ**Adapter Pattern**ï¼‰æ˜¯ä¸€ç§**ç»“æ„å‹è®¾è®¡æ¨¡å¼**ï¼Œç”¨äº**æ¡¥æ¥æ¥å£ä¸å…¼å®¹çš„å¯¹è±¡**ï¼Œä½¿å…¶èƒ½å¤ŸååŒå·¥ä½œã€‚æ ¸å¿ƒæ€æƒ³æ˜¯**è½¬æ¢åŒ…è£…**ï¼Œä½¿ä¸åŒæ¥å£èƒ½å¤Ÿäº’ç›¸å…¼å®¹ã€‚

| **ç›®æ ‡æ¥å£ï¼ˆTargetï¼‰**  | å®¢æˆ·ç«¯æœŸæœ›ä½¿ç”¨çš„æ¥å£                          | USB Type-Cæ¥å£è§„èŒƒ       |
| ----------------------- | --------------------------------------------- | ------------------------ |
| **è¢«é€‚é…è€…ï¼ˆAdapteeï¼‰** | å·²æœ‰ä½†æ¥å£ä¸å…¼å®¹çš„å¯¹è±¡                        | è€å¼USB Type-Aè®¾å¤‡       |
| **é€‚é…å™¨ï¼ˆAdapterï¼‰**   | åŒ…è£…Adapteeå¯¹è±¡å¹¶å®ç°Targetæ¥å£ï¼Œå®Œæˆæ¥å£è½¬æ¢ | USB Type-Cè½¬Type-Aè½¬æ¢å™¨ |
| **å®¢æˆ·ç«¯ï¼ˆClientï¼‰**    | é€šè¿‡ç›®æ ‡æ¥å£ä½¿ç”¨é€‚é…åçš„å¯¹è±¡                  | ä½¿ç”¨Type-Cæ¥å£çš„ç”µè„‘     |

```
// ç›®æ ‡æ¥å£ï¼šä¸­å›½æ ‡å‡†æ’åº§
public interface ChineseSocket {
    String provideCNPlug();
}

// è¢«é€‚é…è€…ï¼šç¾å›½æ ‡å‡†æ’åº§
public class AmericanSocket {
    public String provideUSPlug() {
        return "ç¾å›½ä¸¤æ‰ä¸€åœ†æ’åº§";
    }
}

// é€‚é…å™¨ï¼ˆæŒæœ‰è¢«é€‚é…è€…å®ä¾‹ï¼‰
public class SocketAdapter implements ChineseSocket {
    private AmericanSocket americanSocket;
    
    public SocketAdapter(AmericanSocket socket) {
        this.americanSocket = socket;
    }
    
    @Override
    public String provideCNPlug() {
        String usPlug = americanSocket.provideUSPlug();
        return convertUSToCN(usPlug);
    }
    
    private String convertUSToCN(String usPlug) {
        return usPlug.replace("ç¾å›½ä¸¤æ‰ä¸€åœ†", "ä¸­å›½ä¸‰æ‰è„š");
    }
}

// å®¢æˆ·ç«¯ä½¿ç”¨
public class Traveler {
    public static void main(String[] args) {
        AmericanSocket usSocket = new AmericanSocket();
        ChineseSocket adapter = new SocketAdapter(usSocket);
        System.out.println("ä½¿ç”¨ï¼š" + adapter.provideCNPlug());
        // è¾“å‡ºï¼šä½¿ç”¨ï¼šä¸­å›½ä¸‰æ‰è„šæ’åº§
    }
}
```

**ä½•æ—¶ä½¿ç”¨**

![image-20250620163700394](https://cdn.jsdelivr.net/gh/FengXueCode/FengXueResource@main/imageimage-20250620163700394.png)

### 3.6 æ¡¥æ¥æ¨¡å¼

æ¡¥æ¥æ¨¡å¼ï¼ˆ**Bridge Pattern**ï¼‰æ˜¯ä¸€ç§**ç»“æ„å‹è®¾è®¡æ¨¡å¼**ï¼Œç”¨äº**è§£è€¦æŠ½è±¡éƒ¨åˆ†ä¸å…¶å®ç°éƒ¨åˆ†**ï¼Œä½¿å®ƒä»¬å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚å®ƒé€šè¿‡**ç»„åˆå–ä»£ç»§æ‰¿**çš„æ–¹å¼ï¼Œè§£å†³å¤šç»´åº¦å˜åŒ–çš„ç±»çˆ†ç‚¸é—®é¢˜ã€‚

|               **è§’è‰²**               |               **èŒè´£**               |        **ç¤ºä¾‹**         |
| :----------------------------------: | :----------------------------------: | :---------------------: |
|       **æŠ½è±¡ï¼ˆAbstractionï¼‰**        | å®šä¹‰é«˜å±‚æ§åˆ¶é€»è¾‘ï¼Œç»´æŠ¤å®ç°éƒ¨åˆ†çš„å¼•ç”¨ |     `RemoteControl`     |
| **æ‰©å±•æŠ½è±¡ï¼ˆRefined Abstractionï¼‰**  |    å¯¹æŠ½è±¡çš„æ‰©å±•ï¼Œæä¾›æ›´ç²¾ç»†çš„æ§åˆ¶    | `AdvancedRemoteControl` |
|       **å®ç°ï¼ˆImplementorï¼‰**        |   å®šä¹‰å®ç°ç±»æ¥å£ï¼Œé€šå¸¸å¯¹åº”åº•å±‚æ“ä½œ   |        `Device`         |
| **å…·ä½“å®ç°ï¼ˆConcrete Implementorï¼‰** |     å®ç°Implementoræ¥å£çš„å…·ä½“ç±»      |      `TV`ã€`Radio`      |

```
// å®ç°è€…æ¥å£ï¼šè®¾å¤‡æ“ä½œ
public interface Device {
    void turnOn();
    void turnOff();
    void setVolume(int percent);
    void setChannel(int channel);
    boolean isEnabled();
}
```

```
// å…·ä½“å®ç°ï¼šç”µè§†æœº
public class TV implements Device {
    private boolean on = false;
    private int volume = 30;
    private int channel = 1;

    @Override
    public void turnOn() { on = true; }
    
    @Override
    public void turnOff() { on = false; }
    
    @Override
    public void setVolume(int percent) {
        volume = Math.min(Math.max(percent, 0), 100);
    }
    
    @Override
    public void setChannel(int channel) {
        this.channel = channel;
    }
    
    @Override
    public boolean isEnabled() {
        return on;
    }
}

// å…·ä½“å®ç°ï¼šæ”¶éŸ³æœº
public class Radio implements Device {
    private boolean enabled;
    private int volume = 50;
    private double frequency = 90.5;

    // å®ç°æ¥å£æ–¹æ³• (ç±»ä¼¼TV)
    // ...
}
```

```
// æŠ½è±¡ï¼šé¥æ§å™¨
public abstract class RemoteControl {
    protected Device device;  // æ¡¥æ¥å…³é”®ï¼šè¿æ¥è®¾å¤‡
    
    public RemoteControl(Device device) {
        this.device = device;
    }
    
    // åŸºæœ¬åŠŸèƒ½
    public void togglePower() {
        if (device.isEnabled()) {
            device.turnOff();
        } else {
            device.turnOn();
        }
    }
    
    public void volumeDown() {
        device.setVolume(device.getVolume() - 10);
    }
    
    public void volumeUp() {
        device.setVolume(device.getVolume() + 10);
    }
    
    public void channelDown() {
        device.setChannel(device.getChannel() - 1);
    }
    
    public void channelUp() {
        device.setChannel(device.getChannel() + 1);
    }
}
```

```
// æ‰©å±•æŠ½è±¡ï¼šå¸¦é™„åŠ åŠŸèƒ½çš„é¥æ§å™¨
public class AdvancedRemoteControl extends RemoteControl {
    public AdvancedRemoteControl(Device device) {
        super(device);
    }
    
    public void mute() {
        device.setVolume(0);
    }
    
    public void presetChannel(int channel) {
        device.setChannel(channel);
        System.out.println("åˆ‡æ¢åˆ°é¢„è®¾é¢‘é“: " + channel);
    }
}
```

```
public class Client {
    public static void main(String[] args) {
        // åˆ›å»ºå…·ä½“è®¾å¤‡
        Device tv = new TV();
        Device radio = new Radio();
        
        // åŸºç¡€é¥æ§å™¨æ§åˆ¶ç”µè§†
        RemoteControl basicRemote = new RemoteControl(tv);
        basicRemote.togglePower(); // æ‰“å¼€ç”µè§†
        basicRemote.volumeUp();
        
        // é«˜çº§é¥æ§å™¨æ§åˆ¶æ”¶éŸ³æœº
        AdvancedRemoteControl advancedRemote = new AdvancedRemoteControl(radio);
        advancedRemote.togglePower(); // æ‰“å¼€æ”¶éŸ³æœº
        advancedRemote.mute();
        advancedRemote.presetChannel(101); // é¢„è®¾éŸ³ä¹é¢‘é“
        
        // åˆ‡æ¢è®¾å¤‡ï¼šåŒä¸€ä¸ªé¥æ§å™¨æ§åˆ¶æ–°è®¾å¤‡
        advancedRemote = new AdvancedRemoteControl(tv);
        advancedRemote.presetChannel(5); // é¢„è®¾æ–°é—»é¢‘é“
    }
}
```

**ä½•æ—¶ä½¿ç”¨**

![image-20250620164946684](https://cdn.jsdelivr.net/gh/FengXueCode/FengXueResource@main/imageimage-20250620164946684.png)